# A performant bridge between fixed-size and variable-size seeding
This repository contains the experiments performed in
[A performant bridge between fixed-size and variable-size seeding](https://doi.org/10.1101/825927 "bioRxiv - preprint").

## Requirements

| Name | Linux install command | Recommended version | Used for... |
|------|-----------------------|---------------------|-------------|
| This repo | `git clone https://github.com/ITBE-Lab/seed-evaluation` | latest | The evaluation scripts themselves. |
| DWGSIM | `git clone --recursive https://github.com/nh13/DWGSIM; make -j32` | 0.1.11 | Generating Illumina reads. |
| SURVIVOR | `git clone https://github.com/ITBE-Lab/SURVIVOR; cd SURVIVOR/Debug; make -j32; cd ..; unzip *.zip` | 1.0.5 | Generating PacBio reads. (Modified by us, to generate an exact amount of reads.) |
| Python 3 | `sudo apt-get install python3` | 3.5.3 | Evaluation scripts are written in python. |
| Bokeh | `sudo apt-get install python3-pip; pip3 install bokeh` | 1.4.0 | Plots the results. |
| MA - The Modular Aligner | see below | 1.1.1-1f5a63f | Implements the runtime sensitive parts in efficient C++ code. |

This has been tested on an Ubuntu 18.04.3 LTS.

## Installing MA - The Modular Aligner

The MA github page can be found [here](https://github.com/ITBE-Lab/MA "The Modular Aligner"). \
The following set of commands sets up MA on your system:
```
git clone https://github.com/ITBE-Lab/MA
git checkout 1f5a63f
mkdir build
cd build
cmake -DWITH_PYTHON=ON ../MA/
make -j32
cd ..
export PYTHONPATH=$PYTHONPATH:`pwd`/build:`pwd`/MA/python
```

You can confirm MA is working via: `./build/maCMD`. \
If you get an error during the cmake setup or compilation, here are some things that might have gone wrong:
- MA is written in C++17, so you will need an appropriate compiler. We recommend GCC 6.3.0 or above.
- Multiple Python 3 instances on your system can confuse cmake.
- The export command (last line in the above setup) is not persistent between different consoles and log-ins.

## Configuring the python scripts

The file `config.py` contains the configuration for the experiments. \
At the minimum you will need ot configure the `dwgsim_str`, `survivor_str` and `survivor_error_profile`
variables to the appropriate paths.
`prefix` needs to be set to the folder that shall contain the temporary and output data of the experiments.
`reference_genome_path` shall be set to the prefix of an index generated by MA. This can be done via `./maCMD --Create_Index <fasta_file_name>,<output_folder>,<index_name>`. `reference_genome_path` should then be set to `<output_folder>/<index_name>`. `<fasta_file_name>` is a FASTA file containing the reference genome you want to perform the experiments on.

## Running the experiments

Once everything is configured, you can run `python3 compute_times.py`. \
This will trigger 4 functions (very bottom of the script):
- `read_generation`: This generates the required reads for all experiments and saves them in the `prefix` folder. Hence, this needs to be run only once and can be removed once the reads are generated.
- `runtime_analysis`: This performs the time evaluation (Figure 4) and generates the indices, therefore it needs to run before the following two functions.
- `seed_entropy_analysis`: The performs the entropy analysis (Figure 5).
- `seed_set_diff_analysis`: This performs the seed set difference analysis (Figure 3).
Double clicking on a plot will toggle the legend.